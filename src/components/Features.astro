---
// Features component for OpenSearch AgentOps marketing website
// Displays four main features with alternating layouts

interface Feature {
  id: string;
  icon: string;
  title: string;
  description: string;
  bullets: string[];
  visualType: 'code' | 'mockup' | 'grid';
  visualContent: any;
  imagePosition: 'left' | 'right';
}

// SVG icon paths
const iconPaths = {
  activity: 'M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z',
  'file-text': 'M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z',
  'check-circle': 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z',
  'zap': 'M13 10V3L4 14h7v7l9-11h-7z',
};

const features: Feature[] = [
  {
    id: 'tracing',
    icon: 'activity',
    title: 'LLM Tracing',
    description: 'Complete visibility into every LLM call with automatic instrumentation and detailed performance metrics.',
    bullets: [
      'Auto instrumentation for popular frameworks',
      'Cost per request tracking',
      'Agent and RAG workflow tracking',
    ],
    visualType: 'code',
    visualContent: {
      language: 'python',
      code: `from agentops import trace

@trace
def my_llm_call(prompt):
    response = openai.chat.completions.create(
        model="gpt-4-turbo",
        messages=[{"role": "user", "content": prompt}]
    )
    return response

# Automatically tracked:
# - Latency, tokens, cost
# - Input/output content
# - Model and parameters`,
    },
    imagePosition: 'right',
  },
  {
    id: 'prompts',
    icon: 'file-text',
    title: 'Prompt Management',
    description: 'Version control and A/B test your prompts with a centralized prompt library and deployment system.',
    bullets: [
      'Version control for prompts',
      'A/B testing and rollback',
      'Collaborative prompt editing',
    ],
    visualType: 'mockup',
    visualContent: {
      type: 'prompt-card',
    },
    imagePosition: 'left',
  },
  {
    id: 'evaluation',
    icon: 'check-circle',
    title: 'Evaluation Framework',
    description: 'Comprehensive evaluation suite with 10+ built-in methods and custom evaluator support.',
    bullets: [
      'Accuracy, relevance, and hallucination detection',
      'Custom evaluator support',
      'Automated regression testing',
    ],
    visualType: 'grid',
    visualContent: {
      items: [
        { title: 'Accuracy', progress: 94 },
        { title: 'Relevance', progress: 88 },
        { title: 'Hallucination', progress: 96 },
        { title: 'Toxicity', progress: 99 },
        { title: 'Bias', progress: 92 },
        { title: 'Coherence', progress: 90 },
        { title: 'Fluency', progress: 95 },
        { title: 'Custom', progress: 87 },
      ],
    },
    imagePosition: 'right',
  },
  {
    id: 'insights',
    icon: 'zap',
    title: 'AI Insights',
    description: 'Intelligent alerts and recommendations powered by automated analysis of your LLM usage patterns.',
    bullets: [
      'Anomaly detection and alerts',
      'Cost optimization recommendations',
      'Performance improvement suggestions',
    ],
    visualType: 'mockup',
    visualContent: {
      type: 'alert-card',
    },
    imagePosition: 'left',
  },
];
---

<section id="features" class="py-20 bg-slate-900">
  <div class="container mx-auto px-6">
    <div class="max-w-6xl mx-auto">
      <!-- Section Header -->
      <div class="text-center mb-16">
        <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
          Everything You Need to Build Production AI
        </h2>
        <p class="text-lg text-slate-400 max-w-3xl mx-auto">
          A complete platform for observability, evaluation, and optimization of your LLM applications
        </p>
      </div>

      <!-- Feature Blocks -->
      <div class="space-y-24">
        {features.map((feature, index) => {
          const isImageLeft = feature.imagePosition === 'left';
          
          return (
            <div 
              class={`feature-block flex flex-col ${isImageLeft ? 'lg:flex-row-reverse' : 'lg:flex-row'} gap-12 items-center`}
              data-feature-id={feature.id}
            >
              <!-- Content Side -->
              <div class="flex-1 space-y-6">
                <!-- Icon -->
                <div class="w-14 h-14 rounded-xl bg-indigo-500/10 border border-indigo-500/20 flex items-center justify-center">
                  <svg 
                    class="w-7 h-7 text-indigo-500" 
                    fill="none" 
                    stroke="currentColor" 
                    viewBox="0 0 24 24"
                    aria-hidden="true"
                  >
                    <path 
                      stroke-linecap="round" 
                      stroke-linejoin="round" 
                      stroke-width="2" 
                      d={iconPaths[feature.icon]}
                    />
                  </svg>
                </div>

                <!-- Title -->
                <h3 class="text-2xl md:text-3xl font-bold text-white">
                  {feature.title}
                </h3>

                <!-- Description -->
                <p class="text-lg text-slate-400 leading-relaxed">
                  {feature.description}
                </p>

                <!-- Bullet Points -->
                <ul class="space-y-3">
                  {feature.bullets.map((bullet) => (
                    <li class="flex items-start gap-3">
                      <svg 
                        class="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0" 
                        fill="none" 
                        stroke="currentColor" 
                        viewBox="0 0 24 24"
                        aria-hidden="true"
                      >
                        <path 
                          stroke-linecap="round" 
                          stroke-linejoin="round" 
                          stroke-width="2" 
                          d="M5 13l4 4L19 7"
                        />
                      </svg>
                      <span class="text-slate-300">{bullet}</span>
                    </li>
                  ))}
                </ul>
              </div>

              <!-- Visual Side -->
              <div class="flex-1 w-full">
                {feature.visualType === 'code' && (
                  <div class="code-snippet rounded-xl overflow-hidden border border-slate-700 bg-slate-950">
                    <!-- Code header -->
                    <div class="flex items-center justify-between px-4 py-3 bg-slate-900 border-b border-slate-700">
                      <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                      </div>
                      <span class="text-xs text-slate-500 font-mono">{feature.visualContent.language}</span>
                    </div>
                    <!-- Code content -->
                    <pre class="p-6 overflow-x-auto"><code class="text-sm font-mono text-slate-300 leading-relaxed">{feature.visualContent.code}</code></pre>
                  </div>
                )}

                {feature.visualType === 'mockup' && feature.visualContent.type === 'prompt-card' && (
                  <div class="prompt-mockup rounded-xl border border-slate-700 bg-slate-900 p-6 space-y-4">
                    <!-- Prompt header -->
                    <div class="flex items-center justify-between">
                      <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-lg bg-indigo-500/10 border border-indigo-500/20 flex items-center justify-center">
                          <svg class="w-5 h-5 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
                          </svg>
                        </div>
                        <div>
                          <div class="text-sm font-semibold text-white">Customer Support Prompt</div>
                          <div class="text-xs text-slate-500">Version 3.2 â€¢ Production</div>
                        </div>
                      </div>
                      <span class="px-2 py-1 text-xs font-semibold bg-green-500/10 text-green-400 rounded border border-green-500/20">Active</span>
                    </div>

                    <!-- Prompt content -->
                    <div class="bg-slate-950 rounded-lg p-4 border border-slate-700">
                      <div class="text-xs text-slate-500 mb-2 font-mono">System Prompt</div>
                      <p class="text-sm text-slate-300 leading-relaxed">
                        You are a helpful customer support assistant. Be concise, friendly, and always verify information before providing answers...
                      </p>
                    </div>

                    <!-- Metrics -->
                    <div class="grid grid-cols-3 gap-3">
                      <div class="text-center p-3 rounded-lg bg-slate-950 border border-slate-700">
                        <div class="text-lg font-bold text-white">94%</div>
                        <div class="text-xs text-slate-500">Success Rate</div>
                      </div>
                      <div class="text-center p-3 rounded-lg bg-slate-950 border border-slate-700">
                        <div class="text-lg font-bold text-white">1.2K</div>
                        <div class="text-xs text-slate-500">Uses Today</div>
                      </div>
                      <div class="text-center p-3 rounded-lg bg-slate-950 border border-slate-700">
                        <div class="text-lg font-bold text-white">$0.12</div>
                        <div class="text-xs text-slate-500">Avg Cost</div>
                      </div>
                    </div>
                  </div>
                )}

                {feature.visualType === 'grid' && (
                  <div class="evaluation-grid grid grid-cols-2 gap-4">
                    {feature.visualContent.items.map((item: any) => (
                      <div class="eval-card p-4 rounded-xl bg-slate-900 border border-slate-700 hover:border-indigo-500/50 transition-colors duration-300">
                        <div class="flex items-center justify-between mb-3">
                          <span class="text-sm font-semibold text-white">{item.title}</span>
                          <span class="text-sm font-bold text-indigo-400">{item.progress}%</span>
                        </div>
                        <!-- Progress bar -->
                        <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
                          <div 
                            class="h-full bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full transition-all duration-500"
                            style={`width: ${item.progress}%`}
                          ></div>
                        </div>
                      </div>
                    ))}
                  </div>
                )}

                {feature.visualType === 'mockup' && feature.visualContent.type === 'alert-card' && (
                  <div class="insights-mockup space-y-4">
                    <!-- Alert card -->
                    <div class="alert-card rounded-xl border border-yellow-500/30 bg-yellow-500/5 p-5">
                      <div class="flex items-start gap-4">
                        <div class="w-10 h-10 rounded-lg bg-yellow-500/10 border border-yellow-500/20 flex items-center justify-center flex-shrink-0">
                          <svg class="w-5 h-5 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                          </svg>
                        </div>
                        <div class="flex-1">
                          <div class="flex items-center justify-between mb-2">
                            <h4 class="text-sm font-semibold text-yellow-400">Cost Spike Detected</h4>
                            <span class="text-xs text-slate-500">2 min ago</span>
                          </div>
                          <p class="text-sm text-slate-300 mb-3">
                            GPT-4 usage increased 340% in the last hour. Consider switching to GPT-3.5 for non-critical requests.
                          </p>
                          <div class="flex items-center gap-2">
                            <button class="px-3 py-1 text-xs font-semibold bg-yellow-500 text-slate-950 rounded hover:bg-yellow-400 transition-colors">
                              View Details
                            </button>
                            <button class="px-3 py-1 text-xs font-semibold text-slate-400 hover:text-white transition-colors">
                              Dismiss
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Insight card -->
                    <div class="insight-card rounded-xl border border-indigo-500/30 bg-indigo-500/5 p-5">
                      <div class="flex items-start gap-4">
                        <div class="w-10 h-10 rounded-lg bg-indigo-500/10 border border-indigo-500/20 flex items-center justify-center flex-shrink-0">
                          <svg class="w-5 h-5 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                          </svg>
                        </div>
                        <div class="flex-1">
                          <div class="flex items-center justify-between mb-2">
                            <h4 class="text-sm font-semibold text-indigo-400">Optimization Opportunity</h4>
                            <span class="text-xs text-slate-500">15 min ago</span>
                          </div>
                          <p class="text-sm text-slate-300 mb-3">
                            Your prompt for "summarization" could be 23% shorter without losing quality. Estimated savings: $420/month.
                          </p>
                          <div class="flex items-center gap-2">
                            <button class="px-3 py-1 text-xs font-semibold bg-indigo-500 text-white rounded hover:bg-indigo-400 transition-colors">
                              Apply Suggestion
                            </button>
                            <button class="px-3 py-1 text-xs font-semibold text-slate-400 hover:text-white transition-colors">
                              Learn More
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        })}
      </div>
    </div>
  </div>
</section>

<style>
  /* Respect reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    .eval-card {
      transition: none;
    }
    
    .eval-card .h-full {
      transition: none;
    }
  }
</style>
